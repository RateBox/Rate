const { test, expect } = require('@playwright/test');\n\ntest('Fix bug Seller vá»›i plugin v1.0.6 - Test cuá»‘i cÃ¹ng', async ({ page }) => {\n  test.setTimeout(120000); // 2 phÃºt timeout\n  \n  console.log('ğŸ” Báº¯t Ä‘áº§u fix bug Seller vá»›i plugin v1.0.6...');\n  \n  // ÄÄƒng nháº­p vÃ o Strapi admin\n  await page.goto('http://localhost:1337/admin/auth/login');\n  await page.waitForLoadState('networkidle');\n  \n  await page.fill('input[name=\"email\"]', 'admin@ratebox.vn');\n  await page.fill('input[name=\"password\"]', 'Abc@123456');\n  await page.click('button[type=\"submit\"]');\n  \n  try {\n    await page.waitForURL('**/admin', { timeout: 30000 });\n  } catch (error) {\n    if (page.url().includes('/admin')) {\n      console.log('âœ… ÄÃ£ á»Ÿ admin page');\n    } else {\n      throw error;\n    }\n  }\n  \n  console.log('âœ… ÄÄƒng nháº­p thÃ nh cÃ´ng');\n  \n  // Kiá»ƒm tra version plugin\n  console.log('ğŸ” Kiá»ƒm tra version plugin...');\n  await page.waitForTimeout(2000);\n  \n  const versionElement = await page.locator('div:has-text(\"Smart Filter v1.0.6\")').first();\n  if (await versionElement.isVisible()) {\n    console.log('âœ… Plugin v1.0.6 Ä‘Ã£ load thÃ nh cÃ´ng');\n  } else {\n    console.log('âš ï¸ KhÃ´ng tháº¥y version display, cÃ³ thá»ƒ cáº§n refresh');\n  }\n  \n  // Kiá»ƒm tra táº¥t cáº£ ListingTypes vÃ  ItemField\n  console.log('ğŸ” Kiá»ƒm tra táº¥t cáº£ ListingTypes vÃ  ItemField...');\n  \n  const listingTypes = [\n    { id: 1, name: 'Scammer' },\n    { id: 7, name: 'Bank' },\n    { id: 20, name: 'Scammer' },\n    { id: 21, name: 'Bank' },\n    { id: 22, name: 'Seller' },\n    { id: 23, name: 'Seller' }\n  ];\n  \n  for (const listingType of listingTypes) {\n    console.log(`\\nğŸ” Kiá»ƒm tra ${listingType.name} (ID: ${listingType.id})...`);\n    \n    const apiResponse = await page.request.get(`http://localhost:1337/api/smart-component-filter/listing-type/${listingType.id}/components`);\n    const apiData = await apiResponse.json();\n    \n    console.log(`ğŸ“¦ ${listingType.name} (ID: ${listingType.id}) API Response:`);\n    console.log(`   - Success: ${apiData.success}`);\n    console.log(`   - ListingType found: ${apiData.data?.listingType ? 'YES' : 'NO'}`);\n    console.log(`   - Components count: ${apiData.data?.allowedComponents?.length || 0}`);\n    \n    if (apiData.data?.allowedComponents?.length > 0) {\n      console.log(`   - Components: ${apiData.data.allowedComponents.join(', ')}`);\n    } else {\n      console.log(`   - âŒ NO COMPONENTS FOUND - ItemField likely NULL`);\n    }\n  }\n  \n  // Äi Ä‘áº¿n trang táº¡o item má»›i\n  console.log('\\nğŸ” Äi Ä‘áº¿n trang táº¡o item má»›i...');\n  await page.goto('http://localhost:1337/admin/content-manager/collection-types/api::item.item/create?plugins%5Bi18n%5D%5Blocale%5D=en');\n  await page.waitForLoadState('networkidle');\n  \n  // Kiá»ƒm tra console logs\n  page.on('console', msg => {\n    if (msg.text().includes('Plugin Version') || msg.text().includes('Smart Component Filter')) {\n      console.log(`ğŸ¯ Console: ${msg.text()}`);\n    }\n  });\n  \n  // Test vá»›i Seller\n  console.log('\\nğŸ” Test vá»›i Seller...');\n  \n  // Click vÃ o ListingType dropdown\n  await page.click('[data-strapi-field-name=\"ListingType\"] button');\n  await page.waitForTimeout(1000);\n  \n  // TÃ¬m vÃ  click Seller\n  const sellerOption = page.locator('text=Seller').first();\n  if (await sellerOption.isVisible()) {\n    console.log('âœ… TÃ¬m tháº¥y Seller option');\n    await sellerOption.click();\n    await page.waitForTimeout(2000);\n    \n    console.log('âœ… ÄÃ£ chá»n Seller');\n    \n    // Kiá»ƒm tra Dynamic Zone\n    console.log('ğŸ” Kiá»ƒm tra Dynamic Zone...');\n    \n    // Click vÃ o Dynamic Zone Ä‘á»ƒ má»Ÿ component picker\n    const dynamicZoneButton = page.locator('[data-strapi-field-name=\"FieldGroup\"] button').first();\n    if (await dynamicZoneButton.isVisible()) {\n      console.log('âœ… TÃ¬m tháº¥y Dynamic Zone button');\n      await dynamicZoneButton.click();\n      await page.waitForTimeout(2000);\n      \n      // Kiá»ƒm tra components hiá»ƒn thá»‹\n      const componentButtons = await page.locator('div[role=\"dialog\"] button:not([aria-label])').all();\n      console.log(`ğŸ” Sá»‘ components hiá»ƒn thá»‹: ${componentButtons.length}`);\n      \n      if (componentButtons.length > 0) {\n        console.log('ğŸ“‹ Components hiá»ƒn thá»‹:');\n        for (let i = 0; i < Math.min(componentButtons.length, 10); i++) {\n          const text = await componentButtons[i].textContent();\n          console.log(`   - ${text}`);\n        }\n        \n        // Kiá»ƒm tra xem cÃ³ pháº£i táº¥t cáº£ components hay Ä‘Ã£ Ä‘Æ°á»£c filter\n        if (componentButtons.length > 20) {\n          console.log('âŒ HIá»‚N THá»Š Táº¤T Cáº¢ COMPONENTS - Plugin chÆ°a hoáº¡t Ä‘á»™ng Ä‘Ãºng');\n        } else {\n          console.log('âœ… Components Ä‘Ã£ Ä‘Æ°á»£c filter - Plugin hoáº¡t Ä‘á»™ng Ä‘Ãºng');\n        }\n      } else {\n        console.log('âŒ KhÃ´ng cÃ³ components nÃ o hiá»ƒn thá»‹');\n      }\n      \n      // ÄÃ³ng dialog\n      await page.keyboard.press('Escape');\n    } else {\n      console.log('âŒ KhÃ´ng tÃ¬m tháº¥y Dynamic Zone button');\n    }\n  } else {\n    console.log('âŒ KhÃ´ng tÃ¬m tháº¥y Seller option');\n  }\n  \n  console.log('\\nâœ… Test hoÃ n thÃ nh!');\n}); 